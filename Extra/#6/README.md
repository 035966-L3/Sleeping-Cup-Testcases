### About this problem

This is the hard version of problem B (in Main/#8), which is not used in the contest.

This is an interactive problem.

The interaction is used only to avoid huge I/O (over 5 GB in total).

### General instruction

The testdata input consists of two integers. The first is the test case ID, and the second is a randomly picked RNG seed (32-bit unsigned).

The testdata output consists of three hash values. Checkers use default settings (compare hash values directly).
