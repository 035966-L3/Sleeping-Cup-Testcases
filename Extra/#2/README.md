### About this contest

There is only one problem in the contest.

### About this problem

This is the hard version of problem D (in Main/#2), which is not used in the contest.

The two versions differ only on the time and memory limits.
